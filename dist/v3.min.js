!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("v3",[],e):"object"==typeof exports?exports.v3=e():t.v3=e()}(window,function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var m=e[n]={i:n,l:!1,exports:{}};return t[n].call(m.exports,m,m.exports,i),m.l=!0,m.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},i.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=5)}([function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var m=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=e,this.y=i,this.z=n}return n(t,[{key:"normalize",value:function(){var e=t.getNorm(this);e&&(this.x=this.x/e,this.y=this.y/e,this.z=this.z/e)}},{key:"getVec3FloatArray",value:function(){return new Float32Array([this.x,this.y,this.z])}},{key:Symbol.iterator,value:function(){var t=[this.x,this.y,this.z],e=0;return{next:function(){return{done:e===t.length,value:t[e++]}}}}}],[{key:"isEqual",value:function(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z}},{key:"negate",value:function(e){return new t(-e.x,-e.y,-e.z)}},{key:"plus",value:function(){for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];return 2===i.length?new t(i[0].x+i[1].x,i[0].y+i[1].y,i[0].z+i[1].z):new t(i.map(function(t){return t.x}).reduce(function(t,e){return t+e},0),i.map(function(t){return t.y}).reduce(function(t,e){return t+e},0),i.map(function(t){return t.z}).reduce(function(t,e){return t+e},0))}},{key:"scalarMultiply",value:function(e,i){return new t(e*i.x,e*i.y,e*i.z)}},{key:"getNorm",value:function(t){return Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)}},{key:"getDistance",value:function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)+(t.z-e.z)*(t.z-e.z))}},{key:"dotProduct",value:function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}},{key:"getAngle",value:function(e,i){return Math.acos(t.dotProduct(e,i)/(t.getNorm(e)*t.getNorm(i)))}},{key:"crossProduct",value:function(e,i){return new t(e.y*i.z-e.z*i.y,e.z*i.x-e.x*i.z,e.x*i.y-e.y*i.x)}},{key:"vector3Multiply",value:function(e,i){var n=e.x*i.m14+e.y*i.m24+e.z*i.m34+i.tw;if(0===n)throw Error("Vector3 W = 0 ERROR!");return new t((e.x*i.m11+e.y*i.m21+e.z*i.m31+i.tx)/n,(e.x*i.m12+e.y*i.m22+e.z*i.m32+i.ty)/n,(e.x*i.m13+e.y*i.m23+e.z*i.m33+i.tz)/n)}}]),t}();e.default=m},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.wrapPi=function(t){return t+=Math.PI,t-=2*Math.floor(1*t/2/Math.PI)*Math.PI,t-=Math.PI},e.safeAcos=function(t){if(t>=1)return 0;if(t<=-1)return Math.PI;return Math.acos(t)}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,m=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=i(0),a=(n=r)&&n.__esModule?n:{default:n};function o(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}var s=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,m=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,l=arguments.length>10&&void 0!==arguments[10]?arguments[10]:1,y=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,c=arguments.length>12&&void 0!==arguments[12]?arguments[12]:0,f=arguments.length>13&&void 0!==arguments[13]?arguments[13]:0,v=arguments.length>14&&void 0!==arguments[14]?arguments[14]:0,x=arguments.length>15&&void 0!==arguments[15]?arguments[15]:1;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.m11=e,this.m12=i,this.m13=n,this.m14=m,this.m21=r,this.m22=a,this.m23=o,this.m24=s,this.m31=h,this.m32=u,this.m33=l,this.m34=y,this.tx=c,this.ty=f,this.tz=v,this.tw=x}return m(t,[{key:"scalarMultiply",value:function(e){this.cloneFrom(t.scalarMultiply(e,this))}},{key:"matrix4Multiply",value:function(){for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];this.cloneFrom(t.matrix4Multiply.apply(t,[this].concat(i)))}},{key:"identity",value:function(){this.m11=1,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=1,this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.tx=0,this.ty=0,this.tz=0,this.tw=1}},{key:"clearTranslation",value:function(){this.tx=this.ty=this.tz=0}},{key:"setTranslation",value:function(e){var i=new t(1,0,0,0,0,1,0,0,0,0,1,0,e.x,e.y,e.z,1);this.matrix4Multiply(i)}},{key:"setLocalToParentFromEulerAngle",value:function(e,i){var n=t.fromEulerAngle(i);this.setLocalToParentFromRotationMatrix(e,n)}},{key:"setLocalToParentFromRotationMatrix",value:function(t,e){this.m11=e.m11,this.m12=e.m12,this.m13=e.m13,this.m14=e.m14,this.m21=e.m21,this.m22=e.m22,this.m23=e.m23,this.m24=e.m24,this.m31=e.m31,this.m32=e.m32,this.m33=e.m33,this.m34=e.m34,this.tx=t.x,this.ty=t.y,this.tz=t.z,this.tw=e.tw}},{key:"setParentToLocalFromEulerAngle",value:function(e,i){var n=t.fromEulerAngle(i);this.setParentToLocalFromRotationMatrix(e,n)}},{key:"setParentToLocalFromRotationMatrix",value:function(t,e){this.m11=e.m11,this.m12=e.m12,this.m13=e.m13,this.m14=e.m14,this.m21=e.m21,this.m22=e.m22,this.m23=e.m23,this.m24=e.m24,this.m31=e.m31,this.m32=e.m32,this.m33=e.m33,this.m34=e.m34,this.tx=-(t.x*this.m11+t.y*this.m21+t.z*this.m31),this.ty=-(t.x*this.m12+t.y*this.m22+t.z*this.m32),this.tz=-(t.x*this.m13+t.y*this.m23+t.z*this.m33),this.tw=e.tw}},{key:"setRotateFromXYZAxis",value:function(e,i){var n=Math.sin(i),m=Math.cos(i),r=new t;switch(e){case"x":case"X":r.m11=1,r.m12=0,r.m13=0,r.m14=0,r.m21=0,r.m22=m,r.m23=n,r.m24=0,r.m31=0,r.m32=-n,r.m33=m,r.m34=0;break;case"y":case"Y":r.m11=m,r.m12=0,r.m13=-n,r.m14=0,r.m21=0,r.m22=1,r.m23=0,r.m24=0,r.m31=n,r.m32=0,r.m33=m,r.m34=0;break;case"z":case"Z":r.m11=m,r.m12=n,r.m13=0,r.m14=0,r.m21=-n,r.m22=m,r.m23=0,r.m24=0,r.m31=0,r.m32=0,r.m33=1,r.m34=0}r.tx=0,r.ty=0,r.tz=0,r.tw=1,this.matrix4Multiply(r)}},{key:"setRotateFromVector3",value:function(e,i){if(Math.abs(a.default.getNorm(e)-1)>.01)throw Error("旋转轴向量应为单位向量!");var n=Math.sin(i),m=Math.cos(i),r=1-m,o=r*e.x,s=r*e.y,h=r*e.z,u=new t;u.m11=o*e.x+m,u.m12=o*e.y+e.z*n,u.m13=o*e.z-e.y*n,u.m14=0,u.m21=s*e.x-e.z*n,u.m22=s*e.y+m,u.m23=s*e.z+e.x*n,u.m24=0,u.m31=h*e.x+e.y*n,u.m32=h*e.y-e.x*n,u.m33=h*e.z+m,u.m34=0,u.tx=0,u.ty=0,u.tz=0,u.tw=1,this.matrix4Multiply(u)}},{key:"setScale",value:function(e){var i=new t;i.m11=e.x,i.m12=0,i.m13=0,i.m21=0,i.m22=e.y,i.m23=0,i.m31=0,i.m32=0,i.m33=e.z,i.tx=0,i.ty=0,i.tz=0,i.m14=i.m24=i.m34=0,i.tw=1,this.matrix4Multiply(i)}},{key:"setScaleFromAxis",value:function(e,i){if(Math.abs(a.default.getNorm(e)-1)>.01)throw Error("旋转轴向量应为单位向量!");var n=i-1,m=n*e.x,r=n*e.y,o=n*e.z,s=new t;s.m11=m*e.x+1,s.m22=r*e.y+1,s.m33=o*e.z+1,s.m12=s.m21=m*e.y,s.m13=s.m31=m*e.z,s.m23=s.m32=r*e.z,s.tx=s.ty=s.tz=0,s.m14=s.m24=s.m34=0,s.tw=1,this.matrix4Multiply(s)}},{key:"setShear",value:function(e,i,n){var m=new t;switch(e){case"x":case"X":m.m11=1,m.m12=0,m.m13=0,m.m21=0,m.m22=1,m.m23=0,m.m31=i,m.m32=n,m.m33=1;break;case"y":case"Y":m.m11=1,m.m12=0,m.m13=0,m.m21=i,m.m22=1,m.m23=n,m.m31=0,m.m32=0,m.m33=1;break;case"z":case"Z":m.m11=1,m.m12=i,m.m13=n,m.m21=0,m.m22=1,m.m23=0,m.m31=0,m.m32=0,m.m33=1}m.tx=m.ty=m.tx=0,m.m14=m.m24=m.m34=0,m.tw=1,this.matrix4Multiply(m)}},{key:"setReflection",value:function(e){if(Math.abs(a.default.getNorm(e)-1)>.01)throw Error("反射平面法向量应为单位向量!");var i=-2*e.x,n=-2*e.y,m=-2*e.z,r=new t;r.m11=1+i*e.x,r.m22=1+n*e.y,r.m33=1+m*e.z,r.m12=r.m21=i*e.y,r.m13=r.m31=i*e.z,r.m23=r.m32=n*e.z,r.tx=r.ty=r.tz=0,r.m14=r.m24=r.m34=0,r.tw=1,this.matrix4Multiply(r)}},{key:"transpose",value:function(){var t=[this.m11,this.m21,this.m31,this.tx,this.m12,this.m22,this.m32,this.ty,this.m13,this.m23,this.m33,this.tz,this.m14,this.m24,this.m34,this.tw];this.m11=t[0],this.m12=t[1],this.m13=t[2],this.m14=t[3],this.m21=t[4],this.m22=t[5],this.m23=t[6],this.m24=t[7],this.m31=t[8],this.m32=t[9],this.m33=t[10],this.m34=t[11],this.tx=t[12],this.ty=t[13],this.tz=t[14],this.tw=t[15]}},{key:"getMat4FloatArray",value:function(){return new Float32Array([this.m11,this.m12,this.m13,this.m14,this.m21,this.m22,this.m23,this.m24,this.m31,this.m32,this.m33,this.m34,this.tx,this.ty,this.tz,this.tw])}},{key:"setLookAt",value:function(e,i,n){var m=new t,r=a.default.plus(e,a.default.negate(i));r.normalize();var s=n;s.normalize();var h=a.default.crossProduct(s,r);h.normalize();var u=new(Function.prototype.bind.apply(t,[null].concat(o(h),[0],o(s),[0],o(r),[0,0,0,0,1]))),l=new t;l.setTranslation(a.default.negate(e)),u.transpose();var y=t.matrix4Multiply(l,u);m.m11=y.m11,m.m12=y.m12,m.m13=y.m13,m.m14=y.m14,m.m21=y.m21,m.m22=y.m22,m.m23=y.m23,m.m24=y.m24,m.m31=y.m31,m.m32=y.m32,m.m33=y.m33,m.m34=y.m34,m.tx=y.tx,m.ty=y.ty,m.tz=y.tz,m.tw=y.tw,this.matrix4Multiply(m)}},{key:"setOrtho",value:function(e,i,n,m,r,a){var o=new t;o.m11=2/(i-e),o.m12=0,o.m13=0,o.m14=0,o.m21=0,o.m22=2/(m-n),o.m23=0,o.m24=0,o.m31=0,o.m32=0,o.m33=-2/(a-r),o.m34=0,o.tx=-(i+e)/(i-e),o.ty=-(m+n)/(m-n),o.tz=-(a+r)/(a-r),o.tw=1,this.matrix4Multiply(o)}},{key:"setPerspective",value:function(e,i,n,m){var r=new t,a=Math.tan(Math.PI/2-e/2),o=1/(n-m);r.m11=a/i,r.m12=0,r.m13=0,r.m14=0,r.m21=0,r.m22=a,r.m23=0,r.m24=0,r.m31=0,r.m32=0,r.m33=o*(n+m),r.m34=-1,r.tx=0,r.ty=0,r.tz=2*n*m*o,r.tw=0,this.matrix4Multiply(r)}},{key:"cloneFrom",value:function(t){this.m11=t.m11,this.m12=t.m12,this.m13=t.m13,this.m14=t.m14,this.m21=t.m21,this.m22=t.m22,this.m23=t.m23,this.m24=t.m24,this.m31=t.m31,this.m32=t.m32,this.m33=t.m33,this.m34=t.m34,this.tx=t.tx,this.ty=t.ty,this.tz=t.tz,this.tw=t.tw}},{key:Symbol.iterator,value:function(){var t=[this.m11,this.m12,this.m13,this.m14,this.m21,this.m22,this.m23,this.m24,this.m31,this.m32,this.m33,this.m34,this.tx,this.ty,this.tz,this.tw],e=0;return{next:function(){return{done:e===t.length,value:t[e++]}}}}}],[{key:"scalarMultiply",value:function(e,i){return new t(i.m11*e,i.m12*e,i.m13*e,i.m14*e,i.m21*e,i.m22*e,i.m23*e,i.m24*e,i.m31*e,i.m32*e,i.m33*e,i.m34*e,i.tx*e,i.ty*e,i.tz*e,i.tw*e)}},{key:"fromEulerAngle",value:function(e){var i=Math.sin(e.heading),n=Math.cos(e.heading),m=Math.sin(e.picth),r=Math.cos(e.picth),a=Math.sin(e.bank),o=Math.cos(e.bank);return new t(n*o+i*m*a,-n*a+i*m*o,i*r,0,a*r,o*r,-m,0,-i*o+n*m*a,a*i+n*m*o,n*r,0,0,0,0,1)}},{key:"fromWorldToObjectQuaternion",value:function(e){return new t(1-2*e.y*e.y-2*e.z*e.z,2*e.x*e.y+2*e.w*e.z,2*e.x*e.z-2*e.w*e.y,0,2*e.x*e.y-2*e.w*e.z,1-2*e.x*e.x-2*e.z*e.z,2*e.y*e.z+2*e.w*e.x,0,2*e.x*e.z+2*e.w*e.y,2*e.y*e.z-2*e.w*e.x,1-2*e.x*e.x-2*e.y*e.y,0,0,0,0,1)}},{key:"fromObjectToWorldQuaternion",value:function(e){return new t(1-2*e.y*e.y-2*e.z*e.z,2*e.x*e.y-2*e.w*e.z,2*e.x*e.z+2*e.w*e.y,0,2*e.x*e.y+2*e.w*e.z,1-2*e.x*e.x-2*e.z*e.z,2*e.y*e.z-2*e.w*e.x,0,2*e.x*e.z-2*e.w*e.y,2*e.y*e.z+2*e.w*e.x,1-2*e.x*e.x-2*e.y*e.y,0,0,0,0,1)}},{key:"matrix4Multiply",value:function(){for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];if(i.length<2)throw Error("矩阵叉乘至少需要两个参数");return i.reduce(function(e,i){return new t(e.m11*i.m11+e.m12*i.m21+e.m13*i.m31+e.m14*i.tx,e.m11*i.m12+e.m12*i.m22+e.m13*i.m32+e.m14*i.ty,e.m11*i.m13+e.m12*i.m23+e.m13*i.m33+e.m14*i.tz,e.m11*i.m14+e.m12*i.m24+e.m13*i.m34+e.m14*i.tw,e.m21*i.m11+e.m22*i.m21+e.m23*i.m31+e.m24*i.tx,e.m21*i.m12+e.m22*i.m22+e.m23*i.m32+e.m24*i.ty,e.m21*i.m13+e.m22*i.m23+e.m23*i.m33+e.m24*i.tz,e.m21*i.m14+e.m22*i.m24+e.m23*i.m34+e.m24*i.tw,e.m31*i.m11+e.m32*i.m21+e.m33*i.m31+e.m34*i.tx,e.m31*i.m12+e.m32*i.m22+e.m33*i.m32+e.m34*i.ty,e.m31*i.m13+e.m32*i.m23+e.m33*i.m33+e.m34*i.tz,e.m31*i.m14+e.m32*i.m24+e.m33*i.m34+e.m34*i.tw,e.tx*i.m11+e.ty*i.m21+e.tz*i.m31+e.tw*i.tx,e.tx*i.m12+e.ty*i.m22+e.tz*i.m32+e.tw*i.ty,e.tx*i.m13+e.ty*i.m23+e.tz*i.m33+e.tw*i.tz,e.tx*i.m14+e.ty*i.m24+e.tz*i.m34+e.tw*i.tw)})}}]),t}();e.default=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,m=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=i(0),a=(n=r)&&n.__esModule?n:{default:n},o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(i(1));var s=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,m=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.w=e,this.x=i,this.y=n,this.z=m}return m(t,[{key:"setToRotateAboutX",value:function(t){this.w=Math.cos(t/2),this.x=Math.sin(t/2),this.y=0,this.z=0}},{key:"setToRotateAboutY",value:function(t){this.w=Math.cos(t/2),this.x=0,this.y=Math.sin(t/2),this.z=0}},{key:"setToRotateAboutZ",value:function(t){this.w=Math.cos(t/2),this.x=0,this.y=0,this.z=Math.sin(t/2)}},{key:"setToRotateAboutAxis",value:function(t,e){if(a.default.getNorm(t)-1>=.01)throw Error("构建四元数时，旋转轴向量必须标准化");this.w=Math.cos(e/2),this.x=Math.sin(e/2)*t.x,this.y=Math.sin(e/2)*t.y,this.z=Math.sin(e/2)*t.z}},{key:"normalize",value:function(){var e=t.getNorm(this);e?(this.w=this.w/e,this.x=this.x/e,this.y=this.y/e,this.z=this.z/e):(this.w=1,this.x=0,this.y=0,this.z=0)}},{key:"getRotationAngle",value:function(){return 2*o.safeAcos(this.w)}},{key:"getRotationAxis",value:function(){var t=Math.sqrt(1-this.w*this.w);return t?new a.default(this.x/t,this.y/t,this.z/t):new a.default(1,0,0)}}],[{key:"negate",value:function(e){return new t(-e.w,-e.x,-e.y,-e.z)}},{key:"getNorm",value:function(t){return Math.sqrt(t.w*t.w+t.x*t.x+t.y*t.y+t.z*t.z)}},{key:"getConjugate",value:function(e){return new t(e.w,-e.x,-e.y,-e.z)}},{key:"dotProduct",value:function(t,e){return t.w*e.w+t.x*e.x+t.y*e.y+t.z*e.z}},{key:"crossProduct",value:function(){for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];if(i.length<2)throw Error("四元数叉乘至少需要两个参数");return i.reduce(function(e,i){return new t(e.w*i.w-e.x*i.x-e.y*i.y-e.z*i.z,e.w*i.x+e.x*i.w+e.z*i.y-e.y*i.z,e.w*i.y+e.y*i.w+e.x*i.z-e.z*i.x,e.w*i.z+e.z*i.w+e.y*i.x-e.x*i.y)})}},{key:"scalarMultiply",value:function(e,i){return new t(e*i.w,e*i.x,e*i.y,e*i.z)}},{key:"log",value:function(e){var i=e.getRotationAngle();return new t(0,i/2*e.x,i/2*e.y,i/2*e.z)}},{key:"pow",value:function(e,i){if(Math.abs(e.w)>.999)return e;var n=o.safeAcos(e.w),m=n*i,r=Math.sin(m)/Math.sin(n);return new t(Math.cos(n),e.x*r,e.y*r,e.z*r)}},{key:"getAngularDisplacement",value:function(e,i){return t.crossProduct(t.getConjugate(e),i)}},{key:"slerp",value:function(e,i,n){var m=void 0,r=void 0,a=t.dotProduct(e,i);if(a<0&&(i=t.negate(i),a=-a),a>.9999)m=1-n,r=n;else{var o=Math.sqrt(1-a*a),s=Math.atan2(o,a);m=Math.sin((1-n)*s)/o,r=Math.sin(n*s)/o}return new t(e.w*m+i.w*r,e.x*m+i.x*r,e.y*m+i.y*r,e.z*r+i.z*r)}},{key:"fromRotationMatrix",value:function(e){var i=0,n=0,m=0,r=0,a=e.m11+e.m22+e.m33,o=e.m11-e.m22-e.m33,s=e.m22-e.m11-e.m33,h=e.m33-e.m11-e.m22,u=0,l=a;o>l&&(l=o,u=1),s>l&&(l=s,u=2),h>l&&(l=h,u=3);var y=.5*Math.sqrt(l+1),c=.25/y;switch(u){case 0:i=y,n=(e.m23-e.m32)*c,m=(e.m31-e.m13)*c,r=(e.m12-e.m21)*c;break;case 1:i=y,n=(e.m23-e.m32)*c,m=(e.m12+e.m21)*c,r=(e.m31+e.m13)*c;break;case 2:i=y,n=(e.m31-e.m13)*c,m=(e.m12+e.m21)*c,r=(e.m23+e.m32)*c;break;case 3:i=y,n=(e.m12-e.m21)*c,m=(e.m31+e.m13)*c,r=(e.m23+e.m13)*c}return new t(i,n,m,r)}},{key:"setObjectToWorldFromEulerAngles",value:function(e){var i=Math.sin(e.heading/2),n=Math.cos(e.heading/2),m=Math.sin(e.picth/2),r=Math.cos(e.picth/2),a=Math.sin(e.bank/2),o=Math.cos(e.bank/2);return new t(n*r*o+i*m*a,n*m*o+i*r*a,-n*m*a+i*r*o,-i*m*o+n*r*a)}},{key:"setWorldToObjectFromEulerAngles",value:function(e){return t.getConjugate(t.setObjectToWorldFromEulerAngles(e))}}]),t}();s.QuaternionIdentity=new s(1,0,0,0),e.default=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),m=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(i(1));var r=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.heading=e,this.picth=i,this.bank=n}return n(t,[{key:"canonize",value:function(){this.picth=m.wrapPi(this.picth),this.picth<-2/Math.PI?(this.picth=-Math.PI-this.picth,this.heading+=Math.PI,this.bank+=Math.PI):this.picth>2/Math.PI&&(this.picth=Math.PI-this.picth,this.heading+=Math.PI,this.bank+=Math.PI),Math.abs(this.picth)>Math.PI/2-1e-4?(this.heading+=this.bank,this.bank=0):this.bank=m.wrapPi(this.bank),this.heading=m.wrapPi(this.heading)}}],[{key:"fromRotationMatrix",value:function(e){var i=void 0,n=void 0,m=void 0,r=-e.m23;return Math.abs(r)>.9999?(n=Math.PI/2*r,m=0,i=Math.atan2(-e.m31,e.m11)):(n=Math.asin(r),m=Math.atan2(e.m21,e.m22),i=Math.atan2(e.m13,e.m33)),new t(i,n,m)}},{key:"fromObjectToWorldQuaternion",value:function(e){var i=void 0,n=void 0,m=void 0,r=-2*(e.y*e.z-e.w*e.x);return Math.abs(r)>.9999?(n=Math.PI/2*r,m=0,i=Math.atan2(-e.x*e.z+e.w*e.y,.5-e.y*e.y-e.z*e.z)):(n=Math.asin(r),i=Math.atan2(e.x*e.z+e.w*e.y,.5-e.x*e.x-e.y*e.y),m=Math.atan2(e.x*e.y+e.w*e.z,.5-e.x*e.x-e.z*e.z)),new t(i,n,m)}},{key:"fromWorldToObjectQuaternion",value:function(e){var i=void 0,n=void 0,m=void 0,r=-2*(e.y*e.z+e.w*e.x);return Math.abs(r)>.9999?(n=Math.PI/2*r,m=0,i=Math.atan2(-e.x*e.z-e.w*e.y,.5-e.y*e.y-e.z*e.z)):(n=Math.asin(r),i=Math.atan2(e.x*e.z-e.w*e.y,.5-e.x*e.x-e.y*e.y),m=Math.atan2(e.x*e.y-e.w*e.z,.5-e.x*e.x-e.z*e.z)),new t(i,n,m)}}]),t}();e.default=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Matrix4=e.Quaternion=e.EulerAngles=e.Vector3=void 0;var n=o(i(0)),m=o(i(4)),r=o(i(3)),a=o(i(2));function o(t){return t&&t.__esModule?t:{default:t}}e.Vector3=n.default,e.EulerAngles=m.default,e.Quaternion=r.default,e.Matrix4=a.default}])});